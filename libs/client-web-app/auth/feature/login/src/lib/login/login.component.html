<e-commerce-form-wrapper
  [link]="{ url: '../register', name: 'Stwórz konto!' }"
  header="Witaj ponownie!"
  subtitle="Jesteś tutaj nowy?"
>
  <form
    [formGroup]="loginForm"
    class="flex flex-column gap-3 w-full max-w-30rem xl:align-items-center"
    (submit)="onSubmit()"
  >
    <ng-container
      *ngIf="{
        status: status$ | async,
        errorMessage: errorMessage$ | async
      } as vm"
    >
      <div class="flex flex-column w-full">
        <p-floatLabel>
          <input
            autofocus
            pInputText
            id="email"
            autocomplete="off"
            [ngClass]="{
              'ng-dirty ng-invalid':
                vm.status === 'error' && loginForm.controls.email.invalid
            }"
            formControlName="email"
          />
          <label for="email">Email</label>
        </p-floatLabel>
        <ng-container
          *ngIf="loginForm.controls.email.dirty || vm.status === 'error'"
        >
          <small
            class="text-red-500 mt-1"
            *ngIf="loginForm.controls.email.errors?.['required'] && !vm.errorMessage"
            >To pole jest wymagane
          </small>
          <small
            class="text-red-500 mt-1"
            *ngIf="loginForm.controls.email.errors?.['email']"
            >Wpisz poprawny adres email
          </small>
        </ng-container>
      </div>
      <div class="flex flex-column w-full">
        <p-floatLabel>
          <p-password
            id="password"
            [feedback]="false"
            [toggleMask]="true"
            [ngClass]="{
              'ng-dirty ng-invalid':
                vm.status === 'error' && loginForm.controls.password.invalid
            }"
            formControlName="password"
          ></p-password>
          <label for="password">Hasło</label>
        </p-floatLabel>
        <ng-container
          *ngIf="loginForm.controls.password.dirty || vm.status === 'error'"
        >
          <small
            class="text-red-500 mt-1"
            *ngIf="loginForm.controls.password.errors?.['minlength']"
            >Hasło powinno mieć co najmniej 6 znaków</small
          >
          <small
            class="text-red-500 mt-1"
            *ngIf="loginForm.controls.password.errors?.['required'] && !vm.errorMessage"
            >To pole jest wymagane</small
          >
        </ng-container>
        <div class="text-red-500 mt-4" *ngIf="vm.errorMessage">
          {{ vm.errorMessage }}
        </div>

        <p-button
          type="submit"
          label="Zaloguj się!"
          [loading]="vm.status === 'loading'"
          loading-icon="pi pi-spin pi-spinner"
          iconPos="right"
          class="w-full mt-4"
        ></p-button>
      </div>
    </ng-container>
  </form>
</e-commerce-form-wrapper>
